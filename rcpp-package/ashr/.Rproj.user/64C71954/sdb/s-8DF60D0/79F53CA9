{
    "contents" : "require(ashr)\nrequire(qvalue)\nrequire(fdrtool)\nrequire(mixfdr)\nrequire(locfdr)\nrequire(ggplot2)   \n\nload(\"sim1.RData\")\nload(\"simABC.RData\")\nsource(\"plot_examples.R\")\nsource(\"plot_rmse.R\")\nsource(\"plot_pi0.R\")\nsource(\"plot_lfsr.R\")\n\npdf(\"figures/simABC_egdens.pdf\",width=6.5,height=2)\nplot_examples(list(simA,simB,simC))\ndev.off()\n\npdf(\"figures/rmse_biplot.pdf\",width=6.5,height=2)\nplot_rmse(list(simA,simB,simC))\ndev.off()\n\n#This figure not used in paper?\npdf(\"figures/rmse_biplot_withzerobetahat.pdf\")\nplot_rmse(list(simA,simB,simC),inczero=TRUE,incbetahat=TRUE)\ndev.off()\n\npdf(\"figures/rmse_boxplot.pdf\",width=6.5,height=2)\nplot_rmse_boxplot(list(simA,simB,simC))\ndev.off()\n\npdf(\"figures/rmse_boxplot_extended.pdf\",width=6.5,height=2)\nplot_rmse_boxplot(list(simA,simB,simC),TRUE,TRUE,TRUE)\ndev.off()\n\npdf(\"figures/loglik_boxplot.pdf\",width=6.5,height=2)\nplot_loglik_boxplot(list(simA,simB,simC))\ndev.off()\n\npdf(\"figures/rmse_loglik_boxplot.pdf\",width=6.5,height=5)\nplot_rmse_loglik_boxplot(list(simA,simB,simC))\ndev.off()\n\n\npdf(\"figures/simABC_eg_withfit.pdf\",width=6.5,height=2)\nplot_examples_withfit(list(simA,simB,simC))\ndev.off()\n\npdf(\"figures/simABC_eg_cdf_withfit.pdf\",width=6.5,height=2)\nplot_examples_cdf_withfit(list(simA,simB,simC))\ndev.off()\n\nplot_LR=function(sims){\n  hist(unlist(lapply(sims$fit.ash.u,get_loglik))-unlist(lapply(sims$fit.ash.n,get_loglik)), xlab=\"loglik difference\", main=\"loglik differences for nullbiased prior vs mle\",nclass=10)\n}\n\npdf(\"figures/logLR.pdf\")\nplot_LR(simA)\nplot_LR(simB)\ndev.off()\n\n\n\n\n#Plot pi0 from each method\n\n\npng(\"figures/estpi0_sim1sim2.png\",height=160,width=540)\nplot_pi0(list(simres1a,simres1b,simres2))\ndev.off()\n\n\n\npng(\"figures/lfsdr_sim1sim2_blowup.png\",height=427,width=720)\nplot_lfsdr(list(simres1a,simres1b,simres2),0.1,ptype=\"lfsra\")\ndev.off()\n\npng(\"figures/lfsdr_sim1sim2_blowup.png\",height=427,width=720)\nplot_lfsdr(list(simres1a,simres1b,simres2),0.1,ymax=0.2,ptype=\"lfsra\")\ndev.off()\n\npng(\"figures/lfdr_sim1sim2_blowup.png\",height=160,width=540)\nplot_lfsr(list(simres1a,simres1b,simres2),0.1,ptype=\"lfdr\")\ndev.off()\n\npng(\"figures/lfsra_sim1sim2_blowup.png\",height=160,width=540)\nplot_lfsr(list(simres1a,simres1b,simres2),0.1,ptype=\"lfsra\")\ndev.off()\n\npng(\"figures/lfsra_sim1sim2_blowup.png\",height=160,width=540)\nplot_lfsr(list(simres1a,simres1b,simres2),0.1,ptype=\"lfsr\")\ndev.off()\n\n\n",
    "created" : 1393506617198.000,
    "dirty" : false,
    "encoding" : "UTF-8",
    "folds" : "",
    "hash" : "2698765635",
    "id" : "79F53CA9",
    "lastKnownWriteTime" : 1393461430,
    "path" : "~/Documents/git/ash/paper/Rcode/makefigs.R",
    "project_path" : null,
    "properties" : {
    },
    "source_on_save" : false,
    "type" : "r_source"
}