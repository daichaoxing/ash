% Apaptive Shrinkage and False Discovery Rates by Laplace Approximation
% Matthew Stephens
% 2013/5/13




# Motivation

- A common problem: you have imperfect measurements
of many ``similar" things, and wish to estimate their values. 

- Particularly common in genomics. For example,
 a very common goal is to compare the mean
expression (activity) level of many genes in two conditions.




# Example: Mouse Heart Data




- Data on 150 mouse hearts, disected into left and right ventricle
(courtesy Scott Schmemo, Marcelo Nobrega)

# Example: Mouse Heart Data

```r
head(x)
```

```
##       gene  lv1  lv2   rv1   rv2 genelength
## 1    Itm2a 2236 2174  9484 10883       1626
## 2   Sergef   97   90   341   408       1449
## 3  Fam109a  383  314  1864  2384       2331
## 4     Dhx9 2688 2631 18501 20879       4585
## 5    Ssu72  762  674  2806  3435       1446
## 6 Olfr1018    0    0     0     0        935
```






# Example: Wavelets 


# Borrowing Strength

- Denote the difference in mean between condition 0 and condition 1, for gene $j$, by $\beta_j:= \mu^0_j - \mu^1_j$.

- A fundamental idea is
that the measurements of $\beta_j$ for each gene can be used to improve inference for the values of $\beta$ for other genes.

- Let $\mu^0_j$ and $\mu^1_j$ denote the mean expression 
of gene $j$ ($j=1,\dots,J$) in the two conditions, and define $\beta_j:= \mu^0_j - \mu^1_j$ to be the difference. 

- Typically expression
measurements are made on only a small number of
samples in each condition - sometimes as few as one
sample in each condition. Thus the error in estimates
of $\mu^0_j$ and $\mu^1_j$ is appreciable, and the error
in estimates of $\beta_j$ still greater.



# False Discovery Rates

Standard practice is to estimate an effect size $\beta_j$ and standard error $s_j$ for each gene. 

Then convert this to a $p$ value for each gene, by a $t$ test on $\beta_j/s_j$.

And then use the distribution of $p$ values to estimate the false discovery rate (FDR) at a given threshold.

# False Discovery Rates

![plot of chunk unnamed-chunk-4](figure/unnamed-chunk-4.png) 


# False Discovery Rates

![plot of chunk unnamed-chunk-5](figure/unnamed-chunk-5.png) 



#Why 

- after you finished typing `\documentclass{beamer}` and `\title{}`, I have finished my first slide with markdown
- much less commands to remember, e.g. to write bullet points, just begin with a dash "`-`" instead of `\begin{itemize}` and `\item`; how things can be simpler?
- I know you want math to show you are a statistician, e.g. $f(k)={n \choose k}p^{k}(1-p)^{n-k}$
- you do not need to maintain output -- only maintain a source file
- HTML5/CSS3 is much more fun than LaTeX

# A bit R code


```r
head(cars)
```

```
##   speed dist
## 1     4    2
## 2     4   10
## 3     7    4
## 4     7   22
## 5     8   16
## 6     9   10
```

```r
cor(cars)
```

```
##        speed   dist
## speed 1.0000 0.8069
## dist  0.8069 1.0000
```


# Graphics too


```r
library(ggplot2)
```

```
## Warning: package 'ggplot2' was built under R version 2.15.2
```

```r
qplot(speed, dist, data = cars) + geom_smooth()
```

![A scatterplot of `cars`](figure/graphics.png) 


# How

- source editor: [RStudio](http://www.rstudio.org/) (perfect integration with [**knitr**](http://yihui.name/knitr/); one-click compilation); currently you have to use the version >= 0.96.109
- HTML5 slides converter: [pandoc](http://johnmacfarlane.net/pandoc/); this document was generated by: `pandoc -s -S -i -t dzslides --mathjax knitr-slides.md -o knitr-slides.html`
- the file [`knitr-slides.md`](https://github.com/yihui/knitr-examples/blob/master/009-slides.md) is the markdown output from its [source](https://github.com/yihui/knitr-examples/blob/master/009-slides.Rmd): `library(knitr); knit('knitr-slides.Rmd')`
- or simple click the button `Knit HTML` in RStudio

# For ninjas

- you should tweak the default style; why not try some [Google web fonts](http://www.google.com/webfonts)? (think how painful it is to wrestle with fonts in LaTeX)
- pandoc provides 3 types of HTML5 slides (dzslides is one of them)
- you can tweak the default template to get better appearances
- if you have come up with a better dzslides template, please let me know or contribute to pandoc directly (e.g. `pre` blocks should have `max-width` and `max-height`)

# For beamer lovers

- pandoc supports conversion to beamer as well. period.

# For Powerpoint lovers

- ...

# Reproducible research

It is good to include the session info, e.g. this document is produced with **knitr**. Here is my session info:


```r
print(sessionInfo(), locale = FALSE)
```

```
## R version 2.15.1 (2012-06-22)
## Platform: x86_64-apple-darwin9.8.0/x86_64 (64-bit)
## 
## attached base packages:
## [1] stats     graphics  grDevices utils     datasets  methods   base     
## 
## other attached packages:
## [1] ggplot2_0.9.3.1 qvalue_1.30.0   knitr_1.1      
## 
## loaded via a namespace (and not attached):
##  [1] codetools_0.2-8    colorspace_1.2-1   dichromat_2.0-0   
##  [4] digest_0.6.3       evaluate_0.4.3     formatR_0.7       
##  [7] grid_2.15.1        gtable_0.1.2       labeling_0.1      
## [10] MASS_7.3-23        munsell_0.4        plyr_1.8          
## [13] proto_0.3-10       RColorBrewer_1.0-5 reshape2_1.2.2    
## [16] scales_0.2.3       stringr_0.6.2      tcltk_2.15.1      
## [19] tools_2.15.1
```


# Misc issues

- the plots are too wide? use the chunk option `out.width` which will be used in `<img width=... />`, e.g. `out.width=400px`

# Life is short

- so keep your audience awake!

    
